{"componentChunkName":"component---src-components-post-post-page-tsx","path":"/Nodejs-express-session-ì‚¬ìš©í•˜ê¸°/","result":{"data":{"markdownRemark":{"html":"<h1 id=\"1-ì„œë¡ \" style=\"position:relative;\"><a href=\"#1-%EC%84%9C%EB%A1%A0\" aria-label=\"1 ì„œë¡  permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ì„œë¡ </h1>\n<p>ì§€ë‚œ í¬ìŠ¤íŒ…ì—ì„œ Session ì¸ì¦ ë°©ì‹ì— ëŒ€í•´ì„œ ì•Œì•„ë´¤ë‹¤. ê·¸ë ‡ë‹¤ë©´ Node.jsë¡œ ì–´ë–»ê²Œ Session ì¸ì¦ ë°©ì‹ì„ êµ¬í˜„í•  ìˆ˜ ìˆì„ê¹Œ? ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” Sessionì˜ ì €ì¥ ë°©ì‹ 3ê°€ì§€(ë©”ëª¨ë¦¬, ë””ìŠ¤í¬ ë˜ëŠ” DB) ëª¨ë‘ë¥¼ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•´ë³´ë„ë¡ í•˜ê² ë‹¤. ë§Œì•½ Session ì¸ì¦ ë°©ì‹ì— ëŒ€í•œ ê¸°ë³¸ ê°œë…ì´ ëª…í™•í•˜ì§€ ì•Šë‹¤ë©´ ì§€ë‚œ í¬ìŠ¤íŒ…ì„ ë³´ê³  ì˜¤ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤.</p>\n<h1 id=\"2-í™˜ê²½-ì„¤ì •\" style=\"position:relative;\"><a href=\"#2-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\" aria-label=\"2 í™˜ê²½ ì„¤ì • permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. í™˜ê²½ ì„¤ì •</h1>\n<blockquote>\n<p><strong>ì „ì œ ì¡°ê±´</strong> <br/>\nNode.jsëŠ” ë‹¹ì—°íˆ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤. <br/>\nMySQLë¡œ DB Sessionì„ êµ¬í˜„í•  ê²ƒì´ë¯€ë¡œ MySQLì„ ì„¤ì¹˜í•˜ê¸° ë°”ë€ë‹¤. <br/>\në‹¹ì—°íˆ MySQLì€ RDSë‚˜ Docker ë“±ì˜ ì›ê²© DBë¡œ ëŒ€ì²´ ê°€ëŠ¥í•˜ë‹¤.</p>\n</blockquote>\n<p>ìš°ì„ , ì‹¤ìŠµì„ ì§„í–‰í•  í´ë”ë¥¼ ìƒì„±í•˜ê³  í•„ìš”í•œ ëª¨ë“ˆë“¤ì„ ëª¨ë‘ ì„¤ì¹˜í•˜ë„ë¡ í•˜ì.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># í´ë” ìƒì„± ë° ì—´ê¸°</span>\n<span class=\"token function\">mkdir</span> session-practice\n<span class=\"token builtin class-name\">cd</span> session-practice\n\n<span class=\"token comment\"># package.json ìƒì„±</span>\n<span class=\"token function\">npm</span> init -y\n\n<span class=\"token comment\"># í•„ìš”í•œ ëª¨ë“ˆ ì„¤ì¹˜</span>\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> http express express-session memorystore session-file-store mysql express-mysql-session body-parser</code></pre></div>\n<h1 id=\"3-memory-session-store\" style=\"position:relative;\"><a href=\"#3-memory-session-store\" aria-label=\"3 memory session store permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Memory session store</h1>\n<p>ì²˜ìŒìœ¼ë¡œ ì§„í–‰í•´ë³¼ ì‹¤ìŠµì€ memory session storeì´ë‹¤. ë§ ê·¸ëŒ€ë¡œ sessionì˜ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ëŠ” ë°©ì‹ì´ë‹¤. ì´ ë°©ì‹ì€ session ì •ë³´ë¥¼ ë””ìŠ¤í¬ë‚˜ DBì— ì €ì¥í•˜ëŠ” ê²ƒë³´ë‹¤ í›¨ì”¬ ë¹ ë¥¸ ë°˜ì‘ ì†ë„ë¥¼ ë³´ì¸ë‹¤ëŠ” ì¥ì ì´ ìˆì§€ë§Œ, ê·¸ë§Œí¼ ë©”ëª¨ë¦¬ì— ì ì¬ë˜ëŠ” session ì–‘ì´ ë§ì•„ì¡Œì„ ë•ŒëŠ” ë¶€í•˜ê°€ ì‹¬í•œ ë°©ì‹ì´ê¸°ë„ í•˜ë‹¤. ë”°ë¼ì„œ, ë©”ëª¨ë¦¬ì— ì ì¬ë˜ëŠ” ì–‘ì„ ì¡°ì ˆí•˜ê±°ë‚˜ ì„¸ì…˜ì´ ìœ ì§€ë˜ëŠ” ê¸°ê°„ì„ ì¡°ì ˆí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.</p>\n<p>ì•„ë˜ì˜ ì½”ë“œëŠ” ë¸Œë¼ìš°ì €ë¡œ <a href=\"http://localhost:8080\">http://localhost:8080</a> ì— ì ‘ì†í–ˆì„ ë•Œ, ìƒˆë¡œê³ ì¹¨ì„ í•  ë•Œë§ˆë‹¤ 'View: ' ì˜†ì— ìˆëŠ” ìˆ«ìê°€ ì¦ê°€í•˜ëŠ” ì½”ë“œì´ë‹¤. ì´ëŸ° ë°©ì‹ì´ ê°€ëŠ¥í•œ ì´ìœ ëŠ” sessionì— ìµœê·¼ numì„ ì €ì¥í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ë¸Œë¼ìš°ì €ì—ì„œ ìƒˆë¡œê³ ì¹¨ì´ë‚˜ ì¬ì ‘ì†ì„ í•´ë„ ìœ ì§€ë˜ëŠ” ê²ƒì´ë‹¤.\nì•„ë˜ì˜ ì½”ë“œì—ì„œ checkPeriodëŠ” memorystoreì— ì €ì¥ë  ê¸°ê°„ì„ ì •í•˜ëŠ” ê²ƒì´ë‹¤. ê°€ì¥ ìµœê·¼ ì ‘ì†ì´ checkPeriodë¡œ ì§€ì •ëœ ì‹œê°„ì„ ë„˜ì–´ê°€ë©´ ë©”ëª¨ë¦¬ì˜ ì„¸ì…˜ì€ ìë™ íŒŒê¸°ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// memory-session.js</span>\n\n<span class=\"token keyword\">const</span> http <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> session <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express-session\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> MemoryStore <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"memorystore\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> http<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">8080</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">session</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        secret<span class=\"token operator\">:</span> <span class=\"token string\">\"secret key\"</span><span class=\"token punctuation\">,</span>\n        resave<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        saveUninitialized<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        store<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MemoryStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            checkPeriod<span class=\"token operator\">:</span> <span class=\"token number\">86400000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 24 hours (= 24 * 60 * 60 * 1000 ms)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        cookie<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> maxAge<span class=\"token operator\">:</span> <span class=\"token number\">86400000</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>num <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>num <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>num <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">View: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>num<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Server running on </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PORT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h1 id=\"4-file-session-store\" style=\"position:relative;\"><a href=\"#4-file-session-store\" aria-label=\"4 file session store permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. File session store</h1>\n<p>ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•´ë³¼ ì‹¤ìŠµì€ file session storeì´ë‹¤. ë§ ê·¸ëŒ€ë¡œ sessionì˜ ë°ì´í„°ë¥¼ íŒŒì¼ í˜•íƒœë¡œ ë””ìŠ¤í¬ì— ì €ì¥í•˜ëŠ” ë°©ì‹ì´ë‹¤. ì´ ë°©ì‹ì€ localì— ì €ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ DBë³´ë‹¤ëŠ” ì†ë„ê°€ ë¹ ë¥´ì§€ë§Œ memory ë°©ì‹ë³´ë‹¤ëŠ” ì†ë„ê°€ ëŠë¦¬ë‹¤. í•˜ì§€ë§Œ memoryì— ë¹„í•´ ë””ìŠ¤í¬ê°€ ì €ì¥ ê³µê°„ì´ í›¨ì”¬ ì—¬ìœ ë¡­ë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤. êµ¬í˜„í•˜ëŠ” ë°©ì‹ì€ memory storeì™€ ë¹„ìŠ·í•˜ë‹¤.\nì•„ë˜ì˜ ì½”ë“œë„ memory store ë°©ì‹ë„ ë™ì¼í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ë©° <a href=\"http://localhost:8080\">http://localhost:8080</a> ì— ì ‘ì†í•´ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. file store ë°©ì‹ì˜ íŠ¹ì§•ì€ í•´ë‹¹ íŒŒì¼ì™€ ê°™ì€ ê²½ë¡œì— sessionsë¼ëŠ” í´ë”ê°€ ìƒê¸°ê³  ê·¸ê³³ì— ì„¸ì…˜ì˜ ì •ë³´ê°€ ê¸°ë¡ëœë‹¤ëŠ” ì ì´ë‹¤. ì‹¤í–‰í•´ë³´ë©´ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// file-session.js</span>\n\n<span class=\"token keyword\">const</span> http <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> session <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express-session\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> FileStore <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"session-file-store\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> http<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">8080</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">session</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        secret<span class=\"token operator\">:</span> <span class=\"token string\">\"secret key\"</span><span class=\"token punctuation\">,</span>\n        resave<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        saveUninitialized<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        store<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>num <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>num <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>num <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">View: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>num<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Server running on </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PORT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h1 id=\"5-mysql-session-store\" style=\"position:relative;\"><a href=\"#5-mysql-session-store\" aria-label=\"5 mysql session store permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. MySQL session store</h1>\n<p>mysql session store ë°©ì‹ì—ì„œëŠ” ê°„ë‹¨í•œ ë¡œê·¸ì¸ ì˜ˆì œë¥¼ ë§Œë“¤ì–´ì„œ ì‹¤í–‰í•´ë³´ë„ë¡ í•˜ì. ë¡œê·¸ì¸ì„ í•œ íšŒì›ì´ ë‹¤ì‹œ ìƒˆë¡œê³ ì¹¨ì„ í•œë‹¤ë©´ main í˜ì´ì§€ë¡œ ìë™ìœ¼ë¡œ redirect ë˜ëŠ” ì‹¤ìŠµì„ êµ¬í˜„í•´ë³´ì. ê·¸ ì „ì— ë¨¼ì € íŒŒì¼ ê²½ë¡œì™€ ì‹¤ìŠµì— ì‚¬ìš©í•  Databaseë¥¼ ìƒì„±í•´ë‘ë„ë¡ í•˜ì.</p>\n<h3>í´ë” êµ¬ì¡°</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ğŸ“¦session-practice\n â”£ ğŸ“‚node_modules\n â”£ ğŸ“‚webpage\n â”ƒ â”£ ğŸ“œlogin.html\n â”ƒ â”— ğŸ“œmain.html\n â”£ ğŸ“œdb-session.js\n â”£ ğŸ“œpackage-lock.json\n â”— ğŸ“œpackage.json</code></pre></div>\n<h3>ë°ì´í„° ë² ì´ìŠ¤ ìƒì„±</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\"># MySQL Command Line Client</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">DATABASE</span> session_test<span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"5-1-loginhtml\" style=\"position:relative;\"><a href=\"#5-1-loginhtml\" aria-label=\"5 1 loginhtml permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5-1. login.html</h2>\n<p>ë¡œê·¸ì¸ì„ ì§„í–‰í•  ê°„ë‹¨í•œ html íŒŒì¼ì„ ì‘ì„±í•´ë³´ì. ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê³  submit ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì„œë²„ë¡œ ë¡œê·¸ì¸ ìš”ì²­ì„ ë³´ë‚¸ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>login<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>POST<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/login<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>id<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ì•„ì´ë””<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pw<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ë¹„ë°€ë²ˆí˜¸<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2 id=\"5-2-mainhtml\" style=\"position:relative;\"><a href=\"#5-2-mainhtml\" aria-label=\"5 2 mainhtml permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5-2. main.html</h2>\n<p>ë¡œê·¸ì¸ì´ ì„±ê³µí–ˆì„ ë•Œì˜ main.html íŒŒì¼ì„ ì‘ì„±í•´ë³´ì. ê°„ë‹¨í•˜ê²Œ logout ë²„íŠ¼ë§Œ ì¡´ì¬í•˜ê³  í•´ë‹¹ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì„¸ì…˜ ì •ë³´ê°€ ì‚­ì œë˜ì–´ ë‹¤ì‹œ ë¡œê·¸ì¸ì„ ì§„í–‰í•´ì•¼ í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>main<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/logout<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>logout<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2 id=\"5-3-db-sessionjs\" style=\"position:relative;\"><a href=\"#5-3-db-sessionjs\" aria-label=\"5 3 db sessionjs permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5-3. db-session.js</h2>\n<p>node.js ì„œë²„ë¥¼ ì‘ì„±í•´ë³´ì. userì˜ id, pwëŠ” ì„ì‹œë¡œ ìƒì„±í•œ ê²ƒì´ë¯€ë¡œ ë³¸ì¸ì´ ì›í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•˜ë©´ ëœë‹¤. ë¬¼ë¡  ì €ì¥ì‹œì—ë„ ì €ëŸ° ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ì•ˆ ë˜ê³ , ë°˜ë“œì‹œ pwë¥¼ ì•”í˜¸í™”í•´ì•¼ í•œë‹¤. í¬ê²Œ ì´í•´í•˜ê¸° ì–´ë ¤ìš´ ë¶€ë¶„ì€ ì—†ì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ë¯€ë¡œ session ì„¤ëª…ìœ¼ë¡œ ë„˜ì–´ê°€ê² ë‹¤.\në¡œê·¸ì¸ì´ ì„±ê³µí–ˆì„ ë•Œ sessionì— userë¥¼ ì§€ì •í•œë‹¤. ê·¸ ì´í›„ë¡œëŠ” login í˜ì´ì§€ë¡œ ì´ë™í•˜ë©´ ìë™ìœ¼ë¡œ main í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ ì§„í–‰í•˜ê²Œ ëœë‹¤. ë°˜ëŒ€ë¡œ ë¡œê·¸ì¸ì„ í•˜ì§€ ì•Šì€ userê°€ ë°”ë¡œ main í˜ì´ì§€ë¡œ ì´ë™í•˜ë ¤ í•´ë„ login í˜ì´ì§€ë¡œ ìë™ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ëœë‹¤. ì´ëŸ° ì‹ìœ¼ë¡œ sessionì„ ì²´í¬í•˜ë©´ ë¡œê·¸ì¸ì„ í–ˆëŠ”ì§€ ì•ˆ í–ˆëŠ”ì§€ì— ë”°ë¼ íŠ¹ì • ê¸°ëŠ¥ì„ ë¶€ì—¬í• ì§€ ë§ì§€ë¥¼ ì„ íƒí•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// db-session.js</span>\n\n<span class=\"token keyword\">const</span> http <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> session <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express-session\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fs\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> bodyParser <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"body-parser\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> http<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> MySQLStore <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express-mysql-session\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">8080</span>\n\n<span class=\"token keyword\">const</span> options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    host<span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>\n    port<span class=\"token operator\">:</span> <span class=\"token number\">3306</span><span class=\"token punctuation\">,</span>\n    user<span class=\"token operator\">:</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">,</span>\n    password<span class=\"token operator\">:</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">,</span>\n    database<span class=\"token operator\">:</span> <span class=\"token string\">\"session_test\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> sessionStore <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MySQLStore</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">session</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        secret<span class=\"token operator\">:</span> <span class=\"token string\">\"secret key\"</span><span class=\"token punctuation\">,</span>\n        store<span class=\"token operator\">:</span> sessionStore<span class=\"token punctuation\">,</span>\n        resave<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        saveUninitialized<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>bodyParser<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> extended<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// login í˜ì´ì§€</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>user <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\n\n    fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./webpage/login.html\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">error<span class=\"token punctuation\">,</span> data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;h1>500 error&lt;/h1>\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">writeHead</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"Content-Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text/html\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// ì„ì‹œ user</span>\n<span class=\"token keyword\">const</span> users <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> pw<span class=\"token operator\">:</span> <span class=\"token string\">\"world\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">\"good\"</span><span class=\"token punctuation\">,</span> pw<span class=\"token operator\">:</span> <span class=\"token string\">\"bye\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">// id, pw ì²´í¬</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">login</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">,</span> pw</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> len <span class=\"token operator\">=</span> users<span class=\"token punctuation\">.</span>length\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> len<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>id <span class=\"token operator\">===</span> users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id <span class=\"token operator\">&amp;&amp;</span> pw <span class=\"token operator\">===</span> users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>pw<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> id\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"\"</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// login ìš”ì²­</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>id\n    <span class=\"token keyword\">let</span> pw <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>pw\n\n    <span class=\"token keyword\">let</span> user <span class=\"token operator\">=</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> pw<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>user <span class=\"token operator\">===</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span>\n\n    req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>user <span class=\"token operator\">=</span> user\n    req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;h1>500 error&lt;/h1>\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// main í˜ì´ì§€</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>user <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span>\n\n    fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./webpage/main.html\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">error<span class=\"token punctuation\">,</span> data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;h1>500 error&lt;/h1>\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">writeHead</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"Content-Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text/html\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// logout ìš”ì²­</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/logout\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;h1>500 error&lt;/h1>\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Server running on </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PORT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h1 id=\"ì°¸ê³ \" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"ì°¸ê³  permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ì°¸ê³ ]</h1>\n<ul>\n<li><a href=\"https://www.npmjs.com/package/express-session\">https://www.npmjs.com/package/express-session</a></li>\n<li><a href=\"https://www.npmjs.com/package/session-file-store\">https://www.npmjs.com/package/session-file-store</a></li>\n<li><a href=\"https://www.npmjs.com/package/memorystore\">https://www.npmjs.com/package/memorystore</a></li>\n<li><a href=\"https://www.npmjs.com/package/express-mysql-session\">https://www.npmjs.com/package/express-mysql-session</a></li>\n<li><a href=\"https://opentutorials.org/course/3400/21838\">https://opentutorials.org/course/3400/21838</a></li>\n</ul>","id":"4003d344-b844-50ff-9407-89fef7bae98e","tableOfContents":"<ul>\n<li><a href=\"#1-%EC%84%9C%EB%A1%A0\">1. ì„œë¡ </a></li>\n<li><a href=\"#2-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">2. í™˜ê²½ ì„¤ì •</a></li>\n<li><a href=\"#3-memory-session-store\">3. Memory session store</a></li>\n<li><a href=\"#4-file-session-store\">4. File session store</a></li>\n<li>\n<p><a href=\"#5-mysql-session-store\">5. MySQL session store</a></p>\n<ul>\n<li><a href=\"#5-1-loginhtml\">5-1. login.html</a></li>\n<li><a href=\"#5-2-mainhtml\">5-2. main.html</a></li>\n<li><a href=\"#5-3-db-sessionjs\">5-3. db-session.js</a></li>\n</ul>\n</li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">ì°¸ê³ </a></li>\n</ul>","frontmatter":{"author":"millo","description":"nodejsì—ì„œ sessionì„ ì‚¬ìš©í•œ ì¸ì¦ ë°©ì‹ì„ êµ¬í˜„í•´ë³´ì.","category":"nodejs","released_at":"2021-02-01","updated_at":null,"tags":["Authentication","nodejs","express-session","file store","memory store","MySQL","mysql-session-store"],"title":"[Node.js] express session ì‚¬ìš©í•˜ê¸°","lang":"ko","series":"Authentication ë°©ì‹ ì •ë¦¬í•˜ê¸°","translation":null,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHcnraIYv8A/8QAGhAAAQUBAAAAAAAAAAAAAAAAAgABAxESIP/aAAgBAQABBQItKpXLj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAQADAQAAAAAAAAAAAAAAAAEAERIg/9oACAEBAAY/AjKS9HP/xAAbEAABBAMAAAAAAAAAAAAAAAABABEhMSBRkf/aAAgBAQABPyETLBtxaEIQIruP/9oADAMBAAIAAwAAABAnD//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAwEBPxBUf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQEAAQUBAAAAAAAAAAAAAAERIQAgQVFhcf/aAAgBAQABPxBQNFTb4850WiAy45FTvG3/2Q==","aspectRatio":2.127659574468085,"src":"/static/44cfb2066586ecbff6cdad01355978f8/7d509/nodejs.jpg","srcSet":"/static/44cfb2066586ecbff6cdad01355978f8/f836f/nodejs.jpg 200w,\n/static/44cfb2066586ecbff6cdad01355978f8/2244e/nodejs.jpg 400w,\n/static/44cfb2066586ecbff6cdad01355978f8/7d509/nodejs.jpg 720w","sizes":"(max-width: 720px) 100vw, 720px"}}}},"fields":{"slug":"/Nodejs-express-session-ì‚¬ìš©í•˜ê¸°/"}},"site":{"siteMetadata":{"siteUrl":"https://millo-L.github.io"}},"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"title":"Session ê¸°ë°˜ ì¸ì¦ ë°©ì‹","lang":"ko"},"fields":{"slug":"/Session-ê¸°ë°˜-ì¸ì¦ë°©ì‹/"}}},{"node":{"frontmatter":{"title":"JWT ê¸°ë°˜ ì¸ì¦ ë°©ì‹","lang":"ko"},"fields":{"slug":"/JWT-ê¸°ë°˜-ì¸ì¦ë°©ì‹/"}}},{"node":{"frontmatter":{"title":"[Node.js] express session ì‚¬ìš©í•˜ê¸°","lang":"ko"},"fields":{"slug":"/Nodejs-express-session-ì‚¬ìš©í•˜ê¸°/"}}},{"node":{"frontmatter":{"title":"[Node.js] JWT ì‚¬ìš©í•˜ê¸°","lang":"ko"},"fields":{"slug":"/Nodejs-JWT-ì‚¬ìš©í•˜ê¸°/"}}},{"node":{"frontmatter":{"title":"[Node.js] passport session ì‚¬ìš©í•˜ê¸°","lang":"ko"},"fields":{"slug":"/Nodejs-passport-session-ì‚¬ìš©í•˜ê¸°/"}}},{"node":{"frontmatter":{"title":"OAuth 2.0 ê¸°ë°˜ ì¸ì¦ ë°©ì‹","lang":"ko"},"fields":{"slug":"/OAuth2-ê¸°ë°˜-ì¸ì¦ë°©ì‹/"}}},{"node":{"frontmatter":{"title":"[Node.js] passport Google OAuth 2.0 ë¡œê·¸ì¸ ì‚¬ìš©í•˜ê¸°","lang":"ko"},"fields":{"slug":"/Nodejs-passport-Google-OAuth-2-ë¡œê·¸ì¸-ì‚¬ìš©í•˜ê¸°/"}}}]}},"pageContext":{"slug":"/Nodejs-express-session-ì‚¬ìš©í•˜ê¸°/","series":"Authentication ë°©ì‹ ì •ë¦¬í•˜ê¸°"}},"staticQueryHashes":["1608878238","3469517283","764694655"]}