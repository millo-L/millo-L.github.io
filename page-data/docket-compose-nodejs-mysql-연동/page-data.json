{"componentChunkName":"component---src-components-post-post-page-tsx","path":"/docket-compose-nodejs-mysql-연동/","result":{"data":{"markdownRemark":{"html":"<h1 id=\"1-내가-겪은-문제점들\" style=\"position:relative;\"><a href=\"#1-%EB%82%B4%EA%B0%80-%EA%B2%AA%EC%9D%80-%EB%AC%B8%EC%A0%9C%EC%A0%90%EB%93%A4\" aria-label=\"1 내가 겪은 문제점들 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 내가 겪은 문제점들</h1>\n<h2 id=\"1-1-docker-컨테이너끼리-별도의-처리-없이는-네트워크-연결이-안됨\" style=\"position:relative;\"><a href=\"#1-1-docker-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EB%81%BC%EB%A6%AC-%EB%B3%84%EB%8F%84%EC%9D%98-%EC%B2%98%EB%A6%AC-%EC%97%86%EC%9D%B4%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%97%B0%EA%B2%B0%EC%9D%B4-%EC%95%88%EB%90%A8\" aria-label=\"1 1 docker 컨테이너끼리 별도의 처리 없이는 네트워크 연결이 안됨 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-1. docker 컨테이너끼리 별도의 처리 없이는 네트워크 연결이 안됨</h2>\n<h2 id=\"1-2-서버nodejs와-mysql은-컨테이너-구동-완료-시간이-다르기-때문에-서버가-mysql보다-먼저-완료되면-db-connection이-refuse되는-오류가-발생\" style=\"position:relative;\"><a href=\"#1-2-%EC%84%9C%EB%B2%84nodejs%EC%99%80-mysql%EC%9D%80-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EA%B5%AC%EB%8F%99-%EC%99%84%EB%A3%8C-%EC%8B%9C%EA%B0%84%EC%9D%B4-%EB%8B%A4%EB%A5%B4%EA%B8%B0-%EB%95%8C%EB%AC%B8%EC%97%90-%EC%84%9C%EB%B2%84%EA%B0%80-mysql%EB%B3%B4%EB%8B%A4-%EB%A8%BC%EC%A0%80-%EC%99%84%EB%A3%8C%EB%90%98%EB%A9%B4-db-connection%EC%9D%B4-refuse%EB%90%98%EB%8A%94-%EC%98%A4%EB%A5%98%EA%B0%80-%EB%B0%9C%EC%83%9D\" aria-label=\"1 2 서버nodejs와 mysql은 컨테이너 구동 완료 시간이 다르기 때문에 서버가 mysql보다 먼저 완료되면 db connection이 refuse되는 오류가 발생 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-2. 서버(node.js)와 mysql은 컨테이너 구동 완료 시간이 다르기 때문에 서버가 mysql보다 먼저 완료되면 db connection이 refuse되는 오류가 발생</h2>\n<h1 id=\"2-해결-방법\" style=\"position:relative;\"><a href=\"#2-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\" aria-label=\"2 해결 방법 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 해결 방법</h1>\n<h2 id=\"2-1-1-1에-대한-해결-방법\" style=\"position:relative;\"><a href=\"#2-1-1-1%EC%97%90-%EB%8C%80%ED%95%9C-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\" aria-label=\"2 1 1 1에 대한 해결 방법 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-1. 1-1에 대한 해결 방법</h2>\n<p>도커느님께서는 이러한 경우에 대한 해결책으로 link라는 개념을 가지고 있었다. 하지만 link 개념은 더 이상 지원하지 않는 개념이므로 network를 사용했다.\n어찌됐든 일단 제가 해결한 방법을 말하자면, docker-compose.yml 파일과 다른 파일들과의 상대적 경로를 확인은 아래에 파일 경로를 보면 되고</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">📦think\n ┣ 📂db\n ┃ ┣ 📂data\n ┃ ┣ 📂init\n ┃ ┃ ┗ 📜db.sql\n ┃ ┗ 📜.gitignore\n ┣ 📂server\n ┃ ┣ 📂dist\n ┃ ┣ 📂node_modules\n ┃ ┣ 📂src\n ┃ ┣ 📜.dockerignore\n ┃ ┣ 📜.env\n ┃ ┣ 📜.gitignore\n ┃ ┣ 📜docker-entrypoint.sh\n ┃ ┣ 📜Dockerfile\n ┃ ┣ 📜package-lock.json\n ┃ ┣ 📜package.json\n ┃ ┗ 📜tsconfig.json\n ┣ 📂web\n ┃ ┣ 📂node_modules\n ┃ ┣ 📂public\n ┃ ┣ 📂src\n ┃ ┣ 📜.babelrc\n ┃ ┣ 📜.dockerignore\n ┃ ┣ 📜.gitignore\n ┃ ┣ 📜Dockerfile\n ┃ ┣ 📜package-lock.json\n ┃ ┣ 📜package.json\n ┃ ┣ 📜README.md\n ┃ ┣ 📜tsconfig.json\n ┃ ┗ 📜yarn.lock\n ┣ 📜docker-compose.yml\n ┗ 📜README.md</code></pre></div>\n<p>실제 docker-compose.yml의 파일 내용은 이렇다!\n일단, server와 web간의 통신을 위한 network는 docker-net이라는 network를 만들어 사용했고, server와 db간의 통신은 db-net이라는 network를 만들어 별도로 사용했다.\nweb와 db가 서버를 거치지 않고 통신하는 경우가 없다는 이유도 있고, 굳이 web과 db가 연결되게 할 필요가 없다는 이유도 있다. (상관 없을 수도 있지만... 혹시 다른 의견이 있으시면 댓글로 알려주세요...감사합니다!)</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.5\"</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">server</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./server\n        <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> 8080<span class=\"token punctuation\">:</span><span class=\"token number\">8080</span>\n        <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> docker<span class=\"token punctuation\">-</span>net\n            <span class=\"token punctuation\">-</span> db<span class=\"token punctuation\">-</span>net\n        <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> db\n        <span class=\"token key atrule\">env_file</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> ./server/.env\n    <span class=\"token key atrule\">web</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./web\n        <span class=\"token key atrule\">stdin_open</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n        <span class=\"token key atrule\">tty</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> 8085<span class=\"token punctuation\">:</span><span class=\"token number\">3000</span>\n        <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> docker<span class=\"token punctuation\">-</span>net\n    <span class=\"token key atrule\">db</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mysql<span class=\"token punctuation\">:</span>8.0.20\n        <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> mysqld <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>default<span class=\"token punctuation\">-</span>authentication<span class=\"token punctuation\">-</span>plugin=mysql_native_password <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>character<span class=\"token punctuation\">-</span>set<span class=\"token punctuation\">-</span>server=utf8mb4 <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>collation<span class=\"token punctuation\">-</span>server=utf8mb4_unicode_ci\n        <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n        <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> ./db/init<span class=\"token punctuation\">:</span>/docker<span class=\"token punctuation\">-</span>entrypoint<span class=\"token punctuation\">-</span>initdb.d\n            <span class=\"token punctuation\">-</span> ./db/data<span class=\"token punctuation\">:</span>/var/lib/mysql\n        <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">MYSQL_ROOT_PASSWORD</span><span class=\"token punctuation\">:</span> root\n        <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> db<span class=\"token punctuation\">-</span>net\n        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> 8086<span class=\"token punctuation\">:</span><span class=\"token number\">3306</span>\n\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">docker-net</span><span class=\"token punctuation\">:</span>\n    db<span class=\"token punctuation\">-</span>net<span class=\"token punctuation\">:</span></code></pre></div>\n<p>이렇게 docker-compose.yml 파일을 만들고 각각을 web, server를 각각 실행시키기 위한 Dockerfile도 완성이 됐다면 docker-compose up을 터미널에 입력해서 docker의 실행사항을 직접 확인해볼 수 있다. 여기서 오류가 난다면 무언가 잘못된거겠죠?? 일단 이렇게만 진행을 하게 되면 web과 server 사이에는 통신이 원활히 진행되지만 server가 db를 connect할 때 ECONNREFUSED 에러가 뜨는 것을 확인할 수 있다.</p>\n<p>그렇다면 이 에러는 어떻게 해결할 수 있을까??</p>\n<h2 id=\"3-2-2-2에-대한-해결-방법\" style=\"position:relative;\"><a href=\"#3-2-2-2%EC%97%90-%EB%8C%80%ED%95%9C-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\" aria-label=\"3 2 2 2에 대한 해결 방법 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-2. 2-2에 대한 해결 방법</h2>\n<p>이 에러가 처음 발생했을 때 이건 또 무엇인가... 하면서 디버깅을 해봤는 데 최종적으로 다다른 결론은 db 컨테이너가 구동 완료된 시점보다 server 컨테이너가 구동 완료된 시점이 빨랐기 때문이었다. server 컨테이너는 이미 구동이 완료되어 mysql에 연결 시도를 하지만 db 컨테이너는 아직 구동이 완료되지 않았기 때문에 connection이 refused 된 것이었다. 이에 대한 해결방법은 server를 실행하기 전에 db 서버의 구동 완료를 확인하는 것이다.</p>\n<p>위의 파일 경로에서 server/docker-entrypoint.sh 파일의 코드를 보자.\ndockerize라는 프로그램은 도커 컨테이너의 실행순서를 결정해줄 수 있는 프로그램이다.\n이로 인해 db 컨테이너의 구동을 확인하고 server를 실행시킬 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"wait db server\"</span>\ndockerize -wait tcp://db:3306 -timeout 20s\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"start node server\"</span>\nnodemon ./dist/</code></pre></div>\n<p>위의 쉘 스크립트 파일을 server의 Dockerfile에서 구동시키면 db서버의 연결이 가능할 때까지 기다리고 node.js server가 실행된다.</p>\n<p>server Dockerfile의 코드를 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> node<span class=\"token punctuation\">:</span>12.18.0\n\n<span class=\"token keyword\">ENV</span> DOCKERIZE_VERSION v0.2.0\n<span class=\"token keyword\">RUN</span> wget https<span class=\"token punctuation\">:</span>//github.com/jwilder/dockerize/releases/download/$DOCKERIZE_VERSION/dockerize<span class=\"token punctuation\">-</span>linux<span class=\"token punctuation\">-</span>amd64<span class=\"token punctuation\">-</span>$DOCKERIZE_VERSION.tar.gz \\\n    &amp;&amp; tar <span class=\"token punctuation\">-</span>C /usr/local/bin <span class=\"token punctuation\">-</span>xzvf dockerize<span class=\"token punctuation\">-</span>linux<span class=\"token punctuation\">-</span>amd64<span class=\"token punctuation\">-</span>$DOCKERIZE_VERSION.tar.gz\n\n\n<span class=\"token keyword\">RUN</span> npm install <span class=\"token punctuation\">-</span>g nodemon\n<span class=\"token keyword\">RUN</span> mkdir <span class=\"token punctuation\">-</span>p /usr/src/app\n<span class=\"token keyword\">WORKDIR</span> /usr/src/app\n\n<span class=\"token keyword\">COPY</span> package*.json ./\n<span class=\"token keyword\">RUN</span> npm install\n\n<span class=\"token keyword\">COPY</span> . .\n\n<span class=\"token keyword\">RUN</span> chmod +x docker<span class=\"token punctuation\">-</span>entrypoint.sh\n<span class=\"token keyword\">ENTRYPOINT</span> ./docker<span class=\"token punctuation\">-</span>entrypoint.sh\n\n<span class=\"token keyword\">RUN</span> npm run build\n\n<span class=\"token keyword\">EXPOSE</span> 8080</code></pre></div>\n<p>아래 코드는 dockerize를 설치하는 작업이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ENV DOCKERIZE_VERSION v0.2.0\nRUN <span class=\"token function\">wget</span> https://github.com/jwilder/dockerize/releases/download/<span class=\"token variable\">$DOCKERIZE_VERSION</span>/dockerize-linux-amd64-<span class=\"token variable\">$DOCKERIZE_VERSION</span>.tar.gz <span class=\"token punctuation\">\\</span>\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">tar</span> -C /usr/local/bin -xzvf dockerize-linux-amd64-<span class=\"token variable\">$DOCKERIZE_VERSION</span>.tar.gz</code></pre></div>\n<p>이렇게 코드를 짜면 server와 db 간의 network 연결과 connection 모두 작동된다.</p>\n<h1 id=\"3-느낀-점\" style=\"position:relative;\"><a href=\"#3-%EB%8A%90%EB%82%80-%EC%A0%90\" aria-label=\"3 느낀 점 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 느낀 점</h1>\n<p>항상 느끼지만 코딩이란 건 오류를 해결해가는 과정인 것 같다. 2일 동안 이 문제로 끙끙거렸는 데, 항상 그렇듯 해결하고 나니 홀가분해지고 뿌듯함이 느껴진다. 혹시 똑같은 문제로 고통 받고 계시다면 이 글이 조금이나마 도움이 됐으면 한다.</p>\n<h2 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[참고]</h2>\n<ul>\n<li><a href=\"https://jupiny.com/2016/11/13/conrtrol-container-startup-order-in-compose/\">https://jupiny.com/2016/11/13/conrtrol-container-startup-order-in-compose/</a></li>\n<li><a href=\"https://odysseyj.tistory.com/46\">https://odysseyj.tistory.com/46</a></li>\n</ul>","id":"9ea72663-3470-531a-a477-9b376be5f5f2","tableOfContents":"<ul>\n<li>\n<p><a href=\"#1-%EB%82%B4%EA%B0%80-%EA%B2%AA%EC%9D%80-%EB%AC%B8%EC%A0%9C%EC%A0%90%EB%93%A4\">1. 내가 겪은 문제점들</a></p>\n<ul>\n<li><a href=\"#1-1-docker-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EB%81%BC%EB%A6%AC-%EB%B3%84%EB%8F%84%EC%9D%98-%EC%B2%98%EB%A6%AC-%EC%97%86%EC%9D%B4%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%97%B0%EA%B2%B0%EC%9D%B4-%EC%95%88%EB%90%A8\">1-1. docker 컨테이너끼리 별도의 처리 없이는 네트워크 연결이 안됨</a></li>\n<li><a href=\"#1-2-%EC%84%9C%EB%B2%84nodejs%EC%99%80-mysql%EC%9D%80-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EA%B5%AC%EB%8F%99-%EC%99%84%EB%A3%8C-%EC%8B%9C%EA%B0%84%EC%9D%B4-%EB%8B%A4%EB%A5%B4%EA%B8%B0-%EB%95%8C%EB%AC%B8%EC%97%90-%EC%84%9C%EB%B2%84%EA%B0%80-mysql%EB%B3%B4%EB%8B%A4-%EB%A8%BC%EC%A0%80-%EC%99%84%EB%A3%8C%EB%90%98%EB%A9%B4-db-connection%EC%9D%B4-refuse%EB%90%98%EB%8A%94-%EC%98%A4%EB%A5%98%EA%B0%80-%EB%B0%9C%EC%83%9D\">1-2. 서버(node.js)와 mysql은 컨테이너 구동 완료 시간이 다르기 때문에 서버가 mysql보다 먼저 완료되면 db connection이 refuse되는 오류가 발생</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\">2. 해결 방법</a></p>\n<ul>\n<li><a href=\"#2-1-1-1%EC%97%90-%EB%8C%80%ED%95%9C-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\">2-1. 1-1에 대한 해결 방법</a></li>\n<li><a href=\"#3-2-2-2%EC%97%90-%EB%8C%80%ED%95%9C-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\">3-2. 2-2에 대한 해결 방법</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-%EB%8A%90%EB%82%80-%EC%A0%90\">3. 느낀 점</a></p>\n<ul>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"author":"millo","description":"docker-compose로 node.js와 mysql을 연동해보자.","category":"docker","released_at":"2020-12-24","updated_at":null,"tags":["docker","mysql","node.js","docker-compose"],"title":"[Docker] docker-copmose node.js, mysql 연동","lang":"ko","series":"none","translation":null,"image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACTUlEQVQoz4WSX0jTURTHz9127/39NtSBEETWS0+C9FJUJPkQQVlvJkGvgUW4zUm2+Wez1djUUY1AS9Nizc2lgntoakqLTMxcUa4sih7KQqE1inqKNbmd368hNMUufLj3nHvO95xzuQB5i1+cAe5+DPz8FNFUWlWb7K4mzBnfy1omDbSmB/QxQZgtRrjjPugDP4GaB2DdxcxhYE3jwBxxwpruAT07InHXo31IDffMZbhrqkTq/AjGrABmjwH6wRAV/xG03SX0TAB0R+oZJjgl71MheRKCexMZ1jxxjLtnT/D255eZdaiINo4Rw+gGgsqF3PuVSL0pYBemG2VfUrCO+Yyu7cWK5JsXvO1ZlvuSY5L/ncBiLvnqe5A7FzUbChqFgC2I7H+bgO600Hcv/dp0czlLe75k5L70itT1SXDng+Pyre9QkMTR6+6s3yHFcXXmCBReWdCS9pegc881lAYWRfVoSpQEU0J3Iy3ka58F9yRc8vWl1RxWP6wKUsvAv51RpZKpHwosQQ3sOAcCu/SOzNjGXy8/KQt8mCUdr27rW+OH9IPYfThDaG1Qy00hYK0P8e1DKBjJE0QHVQKUTk3hYqM9WniqbxLefPsN8EMAOXi6iDdPgLbKAUyJxTglj+Vy1grihYo5vAtpQWoN1shhY8NQOasbPIoJbhSqQH8lUoWcRCrUn6EK5o3MLCoSBplzdOWS+vG+HME9bEcCyDDal3DXYCGyVhCNvyOolGLwHmQbnvcjm5EDGLMdfcp5J+5lyFbeEIVi/wI+UWhV8A8Fsg4GqI9KWQAAAABJRU5ErkJggg==","aspectRatio":1.7857142857142858,"src":"/static/bb8e5ba3597380023a854295c990e919/ee604/docker.png","srcSet":"/static/bb8e5ba3597380023a854295c990e919/69585/docker.png 200w,\n/static/bb8e5ba3597380023a854295c990e919/497c6/docker.png 400w,\n/static/bb8e5ba3597380023a854295c990e919/ee604/docker.png 800w,\n/static/bb8e5ba3597380023a854295c990e919/db955/docker.png 900w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"fields":{"slug":"/docket-compose-nodejs-mysql-연동/"}},"site":{"siteMetadata":{"siteUrl":"https://millo-L.github.io"}},"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"title":"[Docker] docker-copmose node.js, mysql 연동","lang":"ko"},"fields":{"slug":"/docket-compose-nodejs-mysql-연동/"}}},{"node":{"frontmatter":{"title":"[JavaScript] Callback 지옥 벗어나기","lang":"ko"},"fields":{"slug":"/JavaScript-Callback-지옥-벗어나기/"}}},{"node":{"frontmatter":{"title":"[Docker] Jenkins in Docker(Ubuntu18.04)","lang":"ko"},"fields":{"slug":"/Jenkins-in-Docker-Ubuntu18.04/"}}},{"node":{"frontmatter":{"title":"[Go] 구조체를 Class처럼 사용하기","lang":"ko"},"fields":{"slug":"/Go언어에서-구조체를-Class처럼-사용하기/"}}},{"node":{"frontmatter":{"title":"[Raspberry pi] OpenCV4 설치하기","lang":"ko"},"fields":{"slug":"/Raspberry-pi에-OpenCV4-설치하기/"}}},{"node":{"frontmatter":{"title":"[Python] 간단한 Anaconda 가상 환경 관리하기","lang":"ko"},"fields":{"slug":"/Python-간단한-Anaconda-가상-환경-관리하기/"}}},{"node":{"frontmatter":{"title":"[Python] TCP image socket 구현하기(Server, Client)","lang":"ko"},"fields":{"slug":"/Python-TCP-image-socket-구현하기-Server-Client/"}}},{"node":{"frontmatter":{"title":"[Node.js] express 사용하기","lang":"ko"},"fields":{"slug":"/Nodejs-express-사용하기/"}}},{"node":{"frontmatter":{"title":"[Node.js] express router 사용하기","lang":"ko"},"fields":{"slug":"/Nodejs-express-router-사용하기/"}}},{"node":{"frontmatter":{"title":"[Raspberry pi] 부팅 시 프로그램 자동 실행하기","lang":"ko"},"fields":{"slug":"/Raspberry-pi-부팅시-프로그램-자동-실행하기/"}}},{"node":{"frontmatter":{"title":"[Node.js] moment 사용하기","lang":"ko"},"fields":{"slug":"/Nodejs-moment-사용하기/"}}},{"node":{"frontmatter":{"title":"[Docker] Ubuntu:18.04에서 Docker 설치하기","lang":"ko"},"fields":{"slug":"/Ubuntu-18.04에서-Docker-설치하기/"}}},{"node":{"frontmatter":{"title":"[NGINX] Ubuntu:18.04에서 letsencrypt HTTPS 환경 구축하기","lang":"ko"},"fields":{"slug":"/Ubuntu-18.04에서-letsencrypt-HTTPS-환경구축/"}}},{"node":{"frontmatter":{"title":"[Node.js] nodemailer 사용하기","lang":"ko"},"fields":{"slug":"/Nodejs-nodemailer-사용하기/"}}},{"node":{"frontmatter":{"title":"[Node.js] mysql을 async/await로 처리하기","lang":"ko"},"fields":{"slug":"/Nodejs-mysql을-async-awiat로-처리하기/"}}},{"node":{"frontmatter":{"title":"[Node.js] express cors 사용하기","lang":"ko"},"fields":{"slug":"/Nodejs-express-cors-사용하기/"}}},{"node":{"frontmatter":{"title":"[Node.js] express static folder 지정하기","lang":"ko"},"fields":{"slug":"/Nodejs-express-static-folder-지정하기/"}}},{"node":{"frontmatter":{"title":"[JavaScript] Date 객체 사용하기","lang":"ko"},"fields":{"slug":"/JavaScript-Date-객체-사용하기/"}}},{"node":{"frontmatter":{"title":"[Docker] ReactJS Dockerizing하기","lang":"ko"},"fields":{"slug":"/React-Dockerizing하기/"}}},{"node":{"frontmatter":{"title":"[React Native] 배경 이미지 크기 자동으로 맞추기","lang":"ko"},"fields":{"slug":"/ReactNative-배경-이미지-크기-자동으로-맞추기/"}}},{"node":{"frontmatter":{"title":"[React Native] 커스텀 로딩 애니메이션 스크린 구현하기","lang":"ko"},"fields":{"slug":"/ReactNative-커스텀-로딩-애니메이션-스크린-구현하기/"}}},{"node":{"frontmatter":{"title":"[Node.js] Socket.io 간단한 채팅 구현하기","lang":"ko"},"fields":{"slug":"/Nodejs-socket.io-간단한-채팅-구현하기/"}}},{"node":{"frontmatter":{"title":"[Python] Ubuntu:18.04 에서 jupyter notebook 사용하기","lang":"ko"},"fields":{"slug":"/Python-Ubuntu18.04에서-jupyter-notebook-사용하기/"}}},{"node":{"frontmatter":{"title":"[Network] HTTP 상태(응답) 코드 정리하기","lang":"ko"},"fields":{"slug":"/HTTP-상태코드-정리하기/"}}},{"node":{"frontmatter":{"title":"[Network] SOAP 정리하기","lang":"ko"},"fields":{"slug":"/SOAP-정리하기/"}}},{"node":{"frontmatter":{"title":"[Node.js] slack 연동하기(알림봇 구현)","lang":"ko"},"fields":{"slug":"/Nodejs-slack-연동하기-알림봇구현/"}}},{"node":{"frontmatter":{"title":"[React Native] Dimensions.get('window')와 Dimensions.get('screen')의 차이점","lang":"ko"},"fields":{"slug":"/ReactNative-Dimensions.get-window와-Dimentsions.get-screen의-차이점/"}}},{"node":{"frontmatter":{"title":"[React Native] Bottom tab bar 특정 화면에서 안 보이게 설정하기","lang":"ko"},"fields":{"slug":"/ReactNative-Bottom-tab-bar-특정-화면에서-안-보이게-설정하기/"}}},{"node":{"frontmatter":{"title":"[React Native] 특정 화면에서 화면 고정하기","lang":"ko"},"fields":{"slug":"/ReactNative-특정-화면에서-화면-고정하기/"}}},{"node":{"frontmatter":{"title":"[Node.js] PBKDF2 비밀번호 암호화하기","lang":"ko"},"fields":{"slug":"/Nodejs-PBKDF2-비밀번호-암호화하기/"}}},{"node":{"frontmatter":{"title":"[Network] HTTP란 무엇인가","lang":"ko"},"fields":{"slug":"/HTTP란-무엇인가/"}}},{"node":{"frontmatter":{"title":"[Network] URI와 URL의 차이점","lang":"ko"},"fields":{"slug":"/URI와-URL의-차이점/"}}},{"node":{"frontmatter":{"title":"[Gatsby] build error \"document is not defined\" 해결 방법","lang":"ko"},"fields":{"slug":"/Gatsby-build-error-document-is-not-defined-해결방법/"}}},{"node":{"frontmatter":{"title":"[Gatsby] Troubleshooting build error \"document is not defined\"","lang":"en"},"fields":{"slug":"/Troubleshooting-Gatsby-build-error-document-is-not-defined/"}}},{"node":{"frontmatter":{"title":"[Typescript] mongoose methods, statics 사용하기","lang":"ko"},"fields":{"slug":"/Typescript-mongodb-method-statics-사용하기/"}}}]}},"pageContext":{"slug":"/docket-compose-nodejs-mysql-연동/","series":"none"}},"staticQueryHashes":["1608878238","3469517283","764694655"]}