{"componentChunkName":"component---src-components-post-post-template-tsx","path":"/Nodejs-JWT-사용하기/","result":{"data":{"markdownRemark":{"html":"<h2 id=\"1-서론\" style=\"position:relative;\"><a href=\"#1-%EC%84%9C%EB%A1%A0\" aria-label=\"1 서론 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 서론</h2>\n<p>지난 포스팅에서는 JWT 기반 인증 방식에 대해 알아봤다. 이번엔 Node.js로 JWT를 직접 구현해보도록 하자. 구현 방법은 어렵지 않으나 이 포스팅에서는 jsonwebtoken을 사용한 토큰의 발급과 만료 기간 설정 등 기본 개념에 대한 구현만 하도록 하겠다. 운영하려는 서비스마다 JWT를 사용하는 방식이나 메모리 적재 여부 등이 다르기 때문에 위의 인증 방식 정리하기에서 JWT 기반 인증 방식의 이론적 개념을 보고 필요한 부분을 수정하여 구현해보길 바란다.</p>\n<h2 id=\"2-환경-설정\" style=\"position:relative;\"><a href=\"#2-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\" aria-label=\"2 환경 설정 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 환경 설정</h2>\n<p>우선, 실습을 진행할 폴더를 생성하고 필요한 모듈들을 모두 설치하도록 하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\">## 폴더 생성 및 열기</span>\r\n<span class=\"token function\">mkdir</span> jwt-practice\r\n<span class=\"token builtin class-name\">cd</span> jwt-practice\r\n\r\n<span class=\"token comment\">## package.json 생성</span>\r\n<span class=\"token function\">npm</span> init <span class=\"token parameter variable\">-y</span>\r\n\r\n<span class=\"token comment\">## 필요한 모듈 설치</span>\r\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> http express body-parser jsonwebtoken dotenv</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"3-폴더-구조\" style=\"position:relative;\"><a href=\"#3-%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%A1%B0\" aria-label=\"3 폴더 구조 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 폴더 구조</h2>\n<p>폴더 구조는 아래와 같이 access token과 refresh token의 secret key를 저장할 환경 변수 파일(.env)과 실제 구현할 jwt.js 파일로 구성된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">📦jwt-practice\r\n ┣ 📂node_modules\r\n ┣ 📜.env\r\n ┣ 📜jwt.js\r\n ┣ 📜package-lock.json\r\n ┗ 📜package.json</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"4-env\" style=\"position:relative;\"><a href=\"#4-env\" aria-label=\"4 env permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. .env</h2>\n<p>환경 변수를 저장할 파일로써 access token과 refresh token의 secret key를 저장할 파일이다. 일반적으로 secret key는 절대로 외부로 유출되서는 안 되므로 보안을 철저히 해야 한다. 아래의 secret key는 샘플로 만든 랜덤 한 키이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"env\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-env line-numbers\"><code class=\"language-env\">ACCESS_TOKEN_SECRET=d7d34917fbd11fdd89357decfb506b5e563e418bf7b136d30436dfa0dddbd4a6e318099c8e4918b87fd8e47e23196c441a5c892a6895d6061e27f89ed1ba19d6\r\nREFRESH_TOKEN_SECRET=3a13ce20d9e44269e1a01f31e6cb67b6f200450ecc7cf09c3d0a199e512037422145d7727fa874e128bfbbc198b06e99ae1f6e24b57e8cd598102b61bffa8e69</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h2 id=\"5-jwtjs\" style=\"position:relative;\"><a href=\"#5-jwtjs\" aria-label=\"5 jwtjs permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. jwt.js</h2>\n<p>아래의 코드는 임의로 만든 users라는 id, pw 배열을 지정하고(실제로는 pw는 반드시 암호화하여 DB에 저장해야 한다.), 로그인 시 해당 id, pw와 일치하는 요청이 들어오면 access token과 refresh token을 발급하는 코드이다. 이렇게 발급된 token은 클라이언트에서 요청을 보낼 때마다 headers에 authorization: 'bearer ' + accessToken 방식으로 넘겨받아 해당 요청의 token이 유효한 지 검사한다. 자세한 설명은 아래에서 예시를 보며 설명하도록 하겠다.\r\n이 예제에서는 /user 요청에서 token이 유효할 시 id와 pw를 넘겨주는 응답을 보냈는 데 실제로는 pw를 넘겨주는 일은 결코 없으니 유의하기 바란다. 그저 예시일 뿐이란 걸 이해하고 넘어가길 바란다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// jwt.js</span>\r\n\r\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dotenv\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> http <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> jwt <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jsonwebtoken\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> bodyParser <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"body-parser\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> request <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../session-practice/db\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> http<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">8080</span><span class=\"token punctuation\">;</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>bodyParser<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">extended</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>bodyParser<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// 임시 id, pw 배열</span>\r\n<span class=\"token keyword\">const</span> users <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">pw</span><span class=\"token operator\">:</span> <span class=\"token string\">\"world\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token string\">\"good\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">pw</span><span class=\"token operator\">:</span> <span class=\"token string\">\"bye\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// 로그인 id, pw 확인</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">login</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">,</span> pw</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> len <span class=\"token operator\">=</span> users<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> len<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>id <span class=\"token operator\">===</span> users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id <span class=\"token operator\">&amp;&amp;</span> pw <span class=\"token operator\">===</span> users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>pw<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> id<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// access token을 secret key 기반으로 생성</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateAccessToken</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">id</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> jwt<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> id <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN_SECRET</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">expiresIn</span><span class=\"token operator\">:</span> <span class=\"token string\">\"15m\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// refersh token을 secret key  기반으로 생성</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateRefreshToken</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">id</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> jwt<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> id <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">REFRESH_TOKEN_SECRET</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">expiresIn</span><span class=\"token operator\">:</span> <span class=\"token string\">\"180 days\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// login 요청 및 성공시 access token, refresh token 발급</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">let</span> pw <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>pw<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">let</span> user <span class=\"token operator\">=</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> pw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>user <span class=\"token operator\">===</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">let</span> accessToken <span class=\"token operator\">=</span> <span class=\"token function\">generateAccessToken</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">let</span> refreshToken <span class=\"token operator\">=</span> <span class=\"token function\">generateRefreshToken</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> accessToken<span class=\"token punctuation\">,</span> refreshToken <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// access token의 유효성 검사</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">authenticateAccessToken</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> authHeader <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">\"authorization\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">let</span> token <span class=\"token operator\">=</span> authHeader <span class=\"token operator\">&amp;&amp;</span> authHeader<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>token<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"wrong token format or token is not sended\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    jwt<span class=\"token punctuation\">.</span><span class=\"token function\">verify</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">,</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN_SECRET</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">error<span class=\"token punctuation\">,</span> user</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">403</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        req<span class=\"token punctuation\">.</span>user <span class=\"token operator\">=</span> user<span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// access token을 refresh token 기반으로 재발급</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/refresh\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> refreshToken <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>refreshToken<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>refreshToken<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">401</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    jwt<span class=\"token punctuation\">.</span><span class=\"token function\">verify</span><span class=\"token punctuation\">(</span>\r\n        refreshToken<span class=\"token punctuation\">,</span>\r\n        process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">REFRESH_TOKEN_SECRET</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">(</span><span class=\"token parameter\">error<span class=\"token punctuation\">,</span> user</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">403</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n            <span class=\"token keyword\">const</span> accessToken <span class=\"token operator\">=</span> <span class=\"token function\">generateAccessToken</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> accessToken <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// access token 유효성 확인을 위한 예시 요청</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/user\"</span><span class=\"token punctuation\">,</span> authenticateAccessToken<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span> <span class=\"token operator\">=></span> user<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> req<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Server running on </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PORT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"6-실행-예시\" style=\"position:relative;\"><a href=\"#6-%EC%8B%A4%ED%96%89-%EC%98%88%EC%8B%9C\" aria-label=\"6 실행 예시 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 실행 예시</h2>\n<p>이 포스팅에서는 검사 방식으로 postman을 사용했다. 아래와 같이 존재하는 id, pw를 입력하면 access token과 refresh token을 발급받게 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1046px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/30a2b52e711bfd1e844aae63ce7ddbfe/8b70b/jwt1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.78625954198472%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACfUlEQVR42qVUyW4TQRCdX+QHgsQBxRxIiO1IiCUsF+4cyRdw5BQpgTh2ZmxHUcgBCXHkAiHxbD09Sy/jR1U7gwYcIIiSnqpVXfW6qqu6vePDA4zGE0yOjhBMpjgMgh8IJhOMp2Qbj50e+b7DkHByRPuBT3tT+CenOH5/ilfb2/Beb3Vxf/0etjY28HB9Df3OKqGDzTsdPCbbs34fD9bu4kmv62ybtNdb7eBlv4Pn3XU8un0LT1du4MVmD52bK/CKJEUtBGxKOssIpKNzmPACNprBxCFUHKOKIvJJYMm3lhnKOIW8mEF/+Qz7cQrkAgc7O/A0LbQ1sHXtoLRGKhLIPEelFSqlUJJNGQPNsBaG/AxpRXvfpMGHmYUGsLe3B68qCrdhKIhRVRViyiiljCPKKgxDpJRlJlIIyi6jKkS6WFuVY/dTge4bgXNhMdzfJUIiyKR0jryu6XRNxGVZQlUlSkJB11Dk0tkqxqWfpSzn87mrjOVw8A4eG0SSuBNZciqVM2Sp57UL4OCSSHjdgG0NsdLG+Y8OBvB4wScxWNhJUsYs7WBj9BJhk6ExC0LfDxaEbWGH60rj2yTj03xeSfgvpNci/H1GC9Q1ldwqvyk5CK4oWZcFEhoVQV3P8gyStFIVDAGX3bREYGh2TW3cDGujnH3/7e4yIV92UZSQqUBEryFMMoJEGGfISxp0Td3V9iewnWUwGFxVMtxc5WmGWShwFuU4CyW+EuKsgsgVoUIqK6cZUZq72OFwuEzYnr826Ki/NmU4Gv2hKa34eRvzNpqmLAin9MX91xwujQ13mZ9aQR9EcflJ8DtuwK/mVxTkz+++JP+cdEgfiEgWT5V/m+9J307hn2NCVwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jwt1\"\n        title=\"\"\n        src=\"/static/30a2b52e711bfd1e844aae63ce7ddbfe/1c1a4/jwt1.png\"\n        srcset=\"/static/30a2b52e711bfd1e844aae63ce7ddbfe/8ff13/jwt1.png 262w,\n/static/30a2b52e711bfd1e844aae63ce7ddbfe/3e286/jwt1.png 523w,\n/static/30a2b52e711bfd1e844aae63ce7ddbfe/1c1a4/jwt1.png 1046w,\n/static/30a2b52e711bfd1e844aae63ce7ddbfe/8b70b/jwt1.png 1266w\"\n        sizes=\"(max-width: 1046px) 100vw, 1046px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>발급받은 access token을 사용하여 다른 요청을 보낼 때 headers에 authorization: 'bearer ' + access token를 첨부한다. 만약 token이 유효하다면 위에서 설명한 대로 id, pw를 발급받게 된다. (예시일 뿐 실제로 pw를 주는 경우는 결코 없다.)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1046px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7668ad132d1220b55b6c38b98e0c841b/8b70b/jwt2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.78625954198472%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQElEQVR42s1UPW8TQRC9v8gfCBIFitPYcWxLiI8Q0dBTkl9AmyYShtg+fysKKZAQJQ0iju272/vy7e358WaNwcIRkgUFIz3N3uzM25md2XMuu224gyGG4zH6wxG6/f5P9IdDDEa0DQZWu72eRYe4GnO/3+PeCL2ra1x+uMbr01M4b46P8KhyiONqFU8qZdRL+0QJjYMSnlUPcVKv43G5jOe1Gm0HaHCvtl/Cq3oJL44qePrwAU727uFlo4bS/T04ia9QKAUTBCjCEEUk6zm05yH3ifkt9HQCfTtB4c1gFP2iEKkXILqdQn/9AvNpBMQK7fNzOJoLbXKYorDIcg0/8KGiGKnWWBAZofMcuTH0NcjpJ+ssy3AT5fg4pR1As9mEs0gSu5EzSJAtFvB9HwExm04xvfkGxexDZh+IZjXyrVQIk8Vofk5QOwsxUQU679+SkARhFNkAWRueLDpJU+QZv9MYhWTFDGWvkEo29HK5ZGWSH9BtX8ARg2I2iieLCJnH+1s7L2mT4ISVyN4aUlXKQ43hNVGLuJ02HFlIsEBESITAkm3gT7b8R2yP42QJN0UcdhXz3xH+Xrrh2In0+bq2CHWawJ/NEMh4hMqOim0IL35ZrDKRjmvOq8yvNtQ6s/aLd81tQrnomAQpEcerGdV2RjNmU9yZscSItFqtu0uWrhn7QgyWO9yh67rbhJsn7toUt9v9+y6vmrIiHPEX92/HRrocx7HtYpL8asAam09tjYT+8u5t06hn8zmfrmcJ5W/zHR0DUbzI2GWIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jwt2\"\n        title=\"\"\n        src=\"/static/7668ad132d1220b55b6c38b98e0c841b/1c1a4/jwt2.png\"\n        srcset=\"/static/7668ad132d1220b55b6c38b98e0c841b/8ff13/jwt2.png 262w,\n/static/7668ad132d1220b55b6c38b98e0c841b/3e286/jwt2.png 523w,\n/static/7668ad132d1220b55b6c38b98e0c841b/1c1a4/jwt2.png 1046w,\n/static/7668ad132d1220b55b6c38b98e0c841b/8b70b/jwt2.png 1266w\"\n        sizes=\"(max-width: 1046px) 100vw, 1046px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>만약 만료 기간이 지난 경우는 아래와 같이 접근 금지 에러가 발생한다. 이런 경우 access token을 refresh 해야 하는 데 이때 사용하는 토큰이 바로 refresh token이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1046px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0d3769d3a46f8778e319e1ef0a5c3c24/8b70b/jwt3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.78625954198472%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIklEQVR42s1Uu24TQRT1L/IDLihQnCaOsS0hFEJEQ09DfoGWIkVsJbZ3/UAQuUBClDSI2Ot434+ZWR/OnWBkJTFSJBdc6Wh27+PMvXPvTOWz00N/OMRoMoE7GmPgun8xHI+t3hmN7LrW94mrT7QPXdoYdzXFl+kU709PUflw3MSL+iGOGw0c1eto12poEe39Gl41DnHSauHlwQFeN5vU7Vt7c6+Gd60a3jyv4+jZU5xUn+Btu4m9ahWV1A9QhiFMwDWKUMbyfQO1XEL7xM0cyptBzWcolwuYkH5xhGwZIJ57UD9/wHybAGmIy7MzVFQSQhkNU5bQRKEV/MBHGCfIlEJOFITSGtoY+hrrJ99FUeA61vjqUQ/gvHPODNMEmgElnVZEnuXwfR8BsfA8eNe/EDL7iNkHsrIa+Q/DCKZI0Pmeovkxwiwq0e+S0GZGQs0MRAx3zvMcaZZBFzlMlqCUrGgXm2y8ua5WK1anbKzTu0AFd0TIljy/tfOKOglO09Ta1pByM25qDI+Jq8hg0L9PKCS2fCHbwL90cp63hIOHCR8r5g+h4zj/AeHdsm9L1tsJVZbCXyw4iwECDrGMihx+QT2ko2yC4qxmurDzWxiZ08LGXnY79wlLBsVxjJhzp2So2U1ZtQRtyV6aI9Lr9XZ7hlu7/FjSNaHr7qDL9qasCfkM7r5kaYBcfIF0c/N6PQS5gtaXj0oShVhwIkI+cyKdThe/AWRdUjJi4e6iAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jwt3\"\n        title=\"\"\n        src=\"/static/0d3769d3a46f8778e319e1ef0a5c3c24/1c1a4/jwt3.png\"\n        srcset=\"/static/0d3769d3a46f8778e319e1ef0a5c3c24/8ff13/jwt3.png 262w,\n/static/0d3769d3a46f8778e319e1ef0a5c3c24/3e286/jwt3.png 523w,\n/static/0d3769d3a46f8778e319e1ef0a5c3c24/1c1a4/jwt3.png 1046w,\n/static/0d3769d3a46f8778e319e1ef0a5c3c24/8b70b/jwt3.png 1266w\"\n        sizes=\"(max-width: 1046px) 100vw, 1046px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>access token을 재발급받을 때는 refresh token을 서버로 보내야 한다.(refresh token을 기반으로 access token을 발급받기 때문에) 만약 refresh token 또한 만료된 경우는 처음 지정한 자동 로그인 기간이 종료된 것이므로 로그인 페이지로 redirect 시키면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1046px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0097b46c35de2af25d4c6a8dce068a31/8b70b/jwt4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.78625954198472%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXUlEQVR42sVUW2sTURDev+gfEFQQE9CmSSOIl1p88Af4JP0HPvpUMGnaZHdzUWofBPHRF6E22cvZ67lsPmdOsiHYKggFBz7O7MzsNzPnzDnOR/cUI3+MyWwGfzKB6/sbjKdTa/fIzvrI8yyGhLOZB9/34I6n8M7O8enzOd4eHsJ5t9/Bk9Yu9tttPGvtoNt4QGjgcbOBF+1dHHT38HTnEV7udcjWtOiQ/023iVedFp7fv4uD27fwutvBw3t34OSRQCUETByjShJUKesBVBhCRwFkSAhIDy5RBRfQizlMuEBOtvRyDvXjO8zXKZAJnB4dwVGkKKNhqspCaoUojiDSDKWSyMsShVTQFKPJJxXpmnRjIKXERarxZW6gAPT6PThlnluH5kCCJIIwjBBTxUEQYLFYIArmECImCCTUBa9CJDAyw4dvOTrvE/wUBu4JExJBkqY2kPWKq6QERVEQeUG2AkUSI89S62ewn+MMVcnCnbG4g2M4y+USIopsVpbSVhjattjHqAgZdcI+TmSTrZMymVIrYt8dwbEZKFOdrc5ck21Iyf4nGydn8cbjFeG2cMC/Sl2M5/n/mXBp/bwtq32tW69bdukGXSFURY6IRkXQqSdpgpRWHiUtSywrs6lIGRqzStv5VFpa+0m/f5WQN5pPNIkFglBgEaUWQZSgKGlONQ20WmOtZ8WKcDAYXNNyfdLUhlr/WK6hTbWB2tJLqey/w+HoZg9lNPoLIS+/Y/tg6g+ON3pF6LruTVdIhFmWIadDyNePhKIH4jrU95jj+N4XeYYsEfbxEFFoy+31j/ELu7xQKWzryY0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jwt4\"\n        title=\"\"\n        src=\"/static/0097b46c35de2af25d4c6a8dce068a31/1c1a4/jwt4.png\"\n        srcset=\"/static/0097b46c35de2af25d4c6a8dce068a31/8ff13/jwt4.png 262w,\n/static/0097b46c35de2af25d4c6a8dce068a31/3e286/jwt4.png 523w,\n/static/0097b46c35de2af25d4c6a8dce068a31/1c1a4/jwt4.png 1046w,\n/static/0097b46c35de2af25d4c6a8dce068a31/8b70b/jwt4.png 1266w\"\n        sizes=\"(max-width: 1046px) 100vw, 1046px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[참고]</h2>\n<ul>\n<li><a href=\"https://www.npmjs.com/package/jsonwebtoken\">https://www.npmjs.com/package/jsonwebtoken</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=mbsmsi7l3r4\">https://www.youtube.com/watch?v=mbsmsi7l3r4</a></li>\n</ul>","tableOfContents":"<ul>\n<li><a href=\"#1-%EC%84%9C%EB%A1%A0\">1. 서론</a></li>\n<li><a href=\"#2-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">2. 환경 설정</a></li>\n<li><a href=\"#3-%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%A1%B0\">3. 폴더 구조</a></li>\n<li><a href=\"#4-env\">4. .env</a></li>\n<li><a href=\"#5-jwtjs\">5. jwt.js</a></li>\n<li><a href=\"#6-%EC%8B%A4%ED%96%89-%EC%98%88%EC%8B%9C\">6. 실행 예시</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">[참고]</a></li>\n</ul>","frontmatter":{"author":"millo","category":"nodejs","description":"nodejs에서 JWT를 사용한 인증 방식을 구현해보자.","image":{"childImageSharp":{"fixed":{"src":"/static/f695947583c0c0242859d127bd9962e0/2244e/jwt.jpg"}}},"lang":"ko","released_at":"2021-02-01 14:00","series":"Authentication 방식 정리하기","tags":["Authentication","nodejs","jsonwebtoken","JWT","JWT Auth"],"title":"[Node.js] JWT 사용하기","translation":null,"updated_at":null},"fields":{"slug":"/Nodejs-JWT-사용하기/"}},"allMarkdownRemark":{"nodes":[{"frontmatter":{"lang":"ko","title":"Session 기반 인증 방식"},"fields":{"slug":"/Session-기반-인증방식/"}},{"frontmatter":{"lang":"ko","title":"JWT 기반 인증 방식"},"fields":{"slug":"/JWT-기반-인증방식/"}},{"frontmatter":{"lang":"ko","title":"[Node.js] express session 사용하기"},"fields":{"slug":"/Nodejs-express-session-사용하기/"}},{"frontmatter":{"lang":"ko","title":"[Node.js] JWT 사용하기"},"fields":{"slug":"/Nodejs-JWT-사용하기/"}},{"frontmatter":{"lang":"ko","title":"[Node.js] passport session 사용하기"},"fields":{"slug":"/Nodejs-passport-session-사용하기/"}},{"frontmatter":{"lang":"ko","title":"OAuth 2.0 기반 인증 방식"},"fields":{"slug":"/OAuth2-기반-인증방식/"}},{"frontmatter":{"lang":"ko","title":"[Node.js] passport Google OAuth 2.0 로그인 사용하기"},"fields":{"slug":"/Nodejs-passport-Google-OAuth-2-로그인-사용하기/"}}]}},"pageContext":{"slug":"/Nodejs-JWT-사용하기/","series":"Authentication 방식 정리하기"}},"staticQueryHashes":["104535566","2083168511","3061319093","3557473807","356676075","3868781503"],"slicesMap":{}}